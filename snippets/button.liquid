{% comment %}
  Estelle Atelier - Button Snippet
  Reusable button component with theme settings support

  Usage:
    {% render 'button',
      url: '/collections/all',
      text: 'Shop Now',
      style: 'primary',
      size: 'large'
    %}

  Parameters:
    - url: Link URL (required if not button)
    - text: Button text (required)
    - style: 'primary', 'secondary', 'outline', 'ghost', or 'link' (default: 'primary')
    - size: 'small', 'medium', or 'large' (default: 'medium')
    - icon: Optional icon name from icon-svg.liquid
    - external: Open in new tab (default: false)
    - full_width: Button takes full width (default: false)
    - disabled: Button is disabled (default: false)
{% endcomment %}

{%- liquid
  assign style = style | default: 'primary'
  assign size = size | default: 'medium'
  assign is_external = external | default: false
  assign is_full_width = full_width | default: false
  assign is_disabled = disabled | default: false

  comment 'Get button settings from theme'
  assign button_radius = settings.buttons_radius
  assign button_border_width = settings.buttons_border_thickness
  assign button_shadow_offset = settings.buttons_shadow_vertical_offset

  comment 'Base classes'
  assign base_classes = 'inline-flex items-center justify-center font-medium transition-all duration-300 hover-animate'

  comment 'Size classes'
  if size == 'small'
    assign size_classes = 'px-4 py-2 text-xs h-10'
  elsif size == 'large'
    assign size_classes = 'px-10 py-4 text-sm h-14'
  else
    assign size_classes = 'px-6 py-3 text-xs h-12'
  endif

  comment 'Style classes - using CSS variables from theme settings'
  if style == 'primary'
    assign style_classes = 'btn btn-primary'
  elsif style == 'secondary'
    assign style_classes = 'btn btn-secondary'
  elsif style == 'outline'
    assign style_classes = 'btn btn-outline'
  elsif style == 'ghost'
    assign style_classes = 'btn btn-ghost'
  elsif style == 'link'
    assign style_classes = 'btn btn-link'
  endif

  if is_full_width
    assign width_class = 'w-full'
  else
    assign width_class = ''
  endif

  if is_disabled
    assign disabled_attr = 'disabled'
    assign disabled_classes = 'opacity-50 cursor-not-allowed pointer-events-none'
  else
    assign disabled_attr = ''
    assign disabled_classes = ''
  endif

  assign all_classes = base_classes | append: ' ' | append: size_classes | append: ' ' | append: style_classes | append: ' ' | append: width_class | append: ' ' | append: disabled_classes
  assign tracking_class = 'tracking-[0.1em] uppercase'
-%}

{% if url != blank %}
  <a
    href="{{ url }}"
    class="{{ all_classes }} {{ tracking_class }}"
    {% if is_external %}target="_blank" rel="noopener noreferrer"{% endif %}
    {% if is_disabled %}aria-disabled="true"{% endif %}
  >
    {% if icon and style == 'link' %}
      {% render 'icon-svg', icon: icon, size: '20' %}
      <span>{{ text }}</span>
    {% else %}
      <span>{{ text }}</span>
      {% if icon %}
        {% render 'icon-svg', icon: icon, size: '20', class: 'ml-2' %}
      {% endif %}
    {% endif %}
  </a>
{% else %}
  <button
    type="button"
    class="{{ all_classes }} {{ tracking_class }}"
    {{ disabled_attr }}
    {% if is_disabled %}aria-disabled="true"{% endif %}
  >
    {% if icon and style == 'link' %}
      {% render 'icon-svg', icon: icon, size: '20' %}
      <span>{{ text }}</span>
    {% else %}
      <span>{{ text }}</span>
      {% if icon %}
        {% render 'icon-svg', icon: icon, size: '20', class: 'ml-2' %}
      {% endif %}
    {% endif %}
  </button>
{% endif %}

{% schema %}
{
  "name": "Button",
  "tag": "span",
  "class": "inline-block",
  "settings": [
    {
      "type": "select",
      "id": "style",
      "label": "Button style",
      "options": [
        {
          "value": "primary",
          "label": "Primary"
        },
        {
          "value": "secondary",
          "label": "Secondary"
        },
        {
          "value": "outline",
          "label": "Outline"
        },
        {
          "value": "ghost",
          "label": "Ghost"
        },
        {
          "value": "link",
          "label": "Link"
        }
      ],
      "default": "primary"
    },
    {
      "type": "select",
      "id": "size",
      "label": "Button size",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "medium"
    },
    {
      "type": "text",
      "id": "text",
      "label": "Button text",
      "default": "Button text"
    },
    {
      "type": "url",
      "id": "url",
      "label": "Button link"
    }
  ]
}
{% endschema %}

{% style %}
  /* Button styles using CSS variables from theme settings */
  .btn {
    border-radius: var(--buttons-radius, 8px);
    border-width: var(--buttons-border-width, 0);
    box-shadow: var(--buttons-shadow-horizontal-offset, 0)
                var(--buttons-shadow-vertical-offset, 4px)
                var(--buttons-shadow-blur, 10px)
                rgba(var(--color-text-olive-deep, 60, 68, 59), var(--buttons-shadow-opacity, 0));
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Primary button - Sage Dark background */
  .btn-primary {
    background-color: var(--color-sage-dark, #8ba888);
    color: #ffffff;
    border-color: rgba(255, 255, 255, var(--buttons-border-opacity, 1));
  }

  .btn-primary:hover:not(:disabled) {
    background-color: var(--color-sage-accent, #e1e8df);
    color: var(--color-olive-deep, #3c443b);
  }

  /* Secondary button - Sage Pale background */
  .btn-secondary {
    background-color: var(--color-sage-pale, #f1f4f0);
    color: var(--color-olive-deep, #3c443b);
    border-color: rgba(var(--color-text-olive-deep, 60, 68, 59), var(--buttons-border-opacity, 1));
  }

  .btn-secondary:hover:not(:disabled) {
    background-color: var(--color-sage-accent, #e1e8df);
  }

  /* Outline button */
  .btn-outline {
    background-color: transparent;
    color: var(--color-olive-deep, #3c443b);
    border: 2px solid var(--color-olive-deep, #3c443b);
  }

  .btn-outline:hover:not(:disabled) {
    background-color: var(--color-olive-deep, #3c443b);
    color: #ffffff;
  }

  /* Ghost button */
  .btn-ghost {
    background-color: transparent;
    color: var(--color-olive-deep, #3c443b);
    border: none;
  }

  .btn-ghost:hover:not(:disabled) {
    background-color: var(--color-sage-pale, #f1f4f0);
  }

  /* Link button */
  .btn-link {
    background-color: transparent;
    color: var(--color-sage-dark, #8ba888);
    border: none;
    border-bottom: 1px solid rgba(139, 168, 136, 0.3);
    padding-bottom: 0.125rem;
    border-radius: 0;
    box-shadow: none;
  }

  .btn-link:hover:not(:disabled) {
    border-bottom-color: var(--color-sage-dark, #8ba888);
  }

  /* Disabled state override */
  .btn:disabled,
  .btn[aria-disabled="true"] {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }
{% endstyle %}
