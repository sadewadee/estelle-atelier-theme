{% comment %}
  Estelle Atelier - Newsletter Section
  Minimalist email signup with inline validation
{% endcomment %}

<div class="px-6 md:px-12 py-16 md:py-24 {% if section.settings.background_style == 'sage' %}bg-sage-pale{% endif %}" data-section-id="{{ section.id }}">
  <div class="max-w-2xl mx-auto">
    <!-- Top Decorative Element -->
    {% if section.settings.show_decorative_line %}
      <div class="mb-8 h-[1px] w-12 bg-text-olive-deep/20"></div>
    {% endif %}

    <!-- Heading -->
    <h1 class="serif text-text-olive-deep tracking-tight text-3xl md:text-5xl font-normal leading-tight text-center pb-6">
      {{ section.settings.heading }}
    </h1>

    <!-- Description -->
    {% if section.settings.description != blank %}
      <p class="text-text-olive-deep/70 text-lg md:text-xl font-light leading-relaxed pb-12 text-center tracking-wide">
        {{ section.settings.description }}
      </p>
    {% endif %}

    <!-- Signup Form -->
    <div class="max-w-md mx-auto">
      {% form 'customer', class: 'newsletter-form' %}
        <input type="hidden" name="contact[tags]" value="newsletter">

        <div class="flex flex-col gap-4">
          <!-- Email Input -->
          <div class="relative">
            <input
              type="email"
              name="contact[email]"
              id="NewsletterEmail-{{ section.id }}"
              class="w-full border-0 border-b border-sage-accent bg-transparent py-4 px-0 text-text-olive-deep focus:outline-0 focus:border-sage-dark transition-colors placeholder:text-text-olive-deep/30 text-lg font-light leading-normal text-center"
              placeholder="{{ section.settings.placeholder }}"
              required
              aria-label="{{ 'newsletter.label' | t }}"
            >
          </div>

          <!-- Submit Button -->
          <div class="pt-4">
            <button
              type="submit"
              class="w-full flex items-center justify-center overflow-hidden rounded-lg h-14 px-8 bg-sage-dark text-white text-base font-medium leading-normal tracking-[0.1em] uppercase hover:bg-sage-accent hover:text-text-olive-deep transition-all active:scale-[0.98]"
            >
              <span class="truncate">{{ section.settings.button_text }}</span>
            </button>
          </div>
        </div>

        <!-- Privacy Note -->
        {% if section.settings.show_privacy_note %}
          <div class="pt-4">
            <p class="text-[11px] text-text-olive-deep/40 uppercase tracking-[0.2em] text-center">
              {{ section.settings.privacy_note }}
            </p>
          </div>
        {% endif %}

        <!-- Success Message -->
        {% if form.posted_successfully? %}
          <div class="mt-6 p-4 bg-sage-dark/10 rounded-lg text-center">
            <p class="text-sm font-medium text-sage-dark">
              {{ 'newsletter.success' | t | default: 'Thank you for subscribing!' }}
            </p>
          </div>
        {% endif %}

        <!-- Error Message -->
        {% if form.errors %}
          <div class="mt-6 p-4 bg-red-50 rounded-lg text-center">
            <p class="text-sm font-medium text-red-600">
              {{ form.errors.translated_fields['email'] | default: 'Please enter a valid email address.' }}
            </p>
          </div>
        {% endif %}
      {% endform %}
    </div>

    <!-- Bottom Decorative Icons -->
    {% if section.settings.show_decorative_icons %}
      <div class="mt-16 flex gap-6 items-center justify-center opacity-40">
        <span class="material-symbols-outlined text-lg text-sage-dark">eco</span>
        <span class="material-symbols-outlined text-lg text-sage-dark">diamond</span>
        <span class="material-symbols-outlined text-lg text-sage-dark">filter_vintage</span>
      </div>
    {% endif %}
  </div>
</div>

<!-- Decorative Background Elements -->
{% if section.settings.show_decorative_background %}
  <div class="fixed top-0 left-0 w-full h-full pointer-events-none -z-10 overflow-hidden">
    <div class="absolute -top-[20%] -right-[10%] w-[60%] h-[60%] rounded-full bg-sage-dark/5 blur-[120px]"></div>
    <div class="absolute -bottom-[10%] -left-[5%] w-[40%] h-[40%] rounded-full bg-sage-dark/10 blur-[100px]"></div>
  </div>
{% endif %}

{% schema %}
{
  "name": "Newsletter",
  "tag": "section",
  "class": "section-newsletter",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Join the Journal"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Be the first to receive curated collections, seasonal musings, and exclusive invitations to our private events."
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Input placeholder",
      "default": "Enter your email address"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Subscribe"
    },
    {
      "type": "select",
      "id": "background_style",
      "label": "Background",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "sage",
          "label": "Sage pale"
        }
      ],
      "default": "none"
    },
    {
      "type": "checkbox",
      "id": "show_decorative_line",
      "label": "Show decorative line",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_decorative_icons",
      "label": "Show decorative icons",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_decorative_background",
      "label": "Show decorative background",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_privacy_note",
      "label": "Show privacy note",
      "default": true
    },
    {
      "type": "text",
      "id": "privacy_note",
      "label": "Privacy note",
      "default": "Unsubscribe at any time. View our Privacy Policy."
    }
  ],
  "presets": [
    {
      "name": "Newsletter",
      "category": "Promotional"
    }
  ]
}
{% endschema %}
