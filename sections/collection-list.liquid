{% comment %}
  Estelle Atelier - Collection List Grid Section
  Elegant grid display of collections
{% endcomment %}

<div class="px-6 md:px-12 py-16 md:py-24">
  <div class="max-w-[1800px] mx-auto">
    <!-- Section Header -->
    <div class="text-center mb-12">
      {% if section.settings.overline != blank %}
        <span class="text-sage-dark text-xs font-bold uppercase tracking-[0.3em] mb-2 block">
          {{ section.settings.overline }}
        </span>
      {% endif %}
      {% if section.settings.heading != blank %}
        <h2 class="text-text-olive-deep text-3xl md:text-4xl font-bold tracking-tight serif">
          {{ section.settings.heading }}
        </h2>
      {% endif %}
      {% if section.settings.description != blank %}
        <p class="text-muted mt-4 max-w-2xl mx-auto">
          {{ section.settings.description }}
        </p>
      {% endif %}
    </div>

    <!-- Collection Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-{{ section.settings.columns_per_row }} gap-6 md:gap-8">
      {% for block in section.blocks %}
        <div class="collection-item group relative overflow-hidden rounded-xl" {{ block.shopify_attributes }}>
          {% if block.settings.collection != blank %}
            {%- assign collection = collections[block.settings.collection] -%}
            <a href="{{ collection.url }}" class="block">
              {% if collection.image %}
                {{
                  collection.image
                  | image_tag:
                    class: 'w-full aspect-[4/5] object-cover transition-transform duration-700 group-hover:scale-105',
                    loading: 'lazy',
                    widths: '375, 550, 750, 1100, 1600',
                    sizes: '(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw'
                }}
              {% elsif collection.products.first.featured_image %}
                {{
                  collection.products.first.featured_image
                  | image_tag:
                    class: 'w-full aspect-[4/5] object-cover transition-transform duration-700 group-hover:scale-105',
                    loading: 'lazy',
                    widths: '375, 550, 750, 1100, 1600',
                    sizes: '(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw'
                }}
              {% else %}
                <div class="w-full aspect-[4/5] bg-sage-pale flex items-center justify-center">
                  <span class="material-symbols-outlined text-6xl text-sage-dark/20">collections</span>
                </div>
              {% endif %}

              <!-- Overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-text-olive-deep/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>

              <!-- Content -->
              <div class="absolute inset-0 flex flex-col justify-end p-6">
                {% if block.settings.overline != blank %}
                  <span class="text-white/80 text-[10px] font-bold uppercase tracking-[0.2em] mb-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-100">
                    {{ block.settings.overline }}
                  </span>
                {% endif %}
                <h3 class="text-white text-xl md:text-2xl font-bold serif mb-2">
                  {{ collection.title | default: 'Collection' }}
                </h3>
                <span class="text-white/90 text-sm flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-200">
                  {{ 'collections.general.view_all' | t }}
                  <span class="material-symbols-outlined text-lg">arrow_forward</span>
                </span>
              </div>
            </a>
          {% else %}
            <div class="w-full aspect-[4/5] bg-sage-pale flex items-center justify-center">
              <div class="text-center p-6">
                <span class="material-symbols-outlined text-4xl text-sage-dark/20 mb-2">collections</span>
                <p class="text-sm text-muted">{{ 'collections.general.no_collections' | t }}</p>
              </div>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>

    <!-- View All Link -->
    {% if section.settings.show_view_all and section.settings.view_all_link != blank %}
      <div class="text-center mt-12">
        <a
          href="{{ section.settings.view_all_link }}"
          class="inline-flex items-center gap-2 border-2 border-text-olive-deep text-text-olive-deep px-8 py-4 rounded-lg text-sm font-bold uppercase tracking-widest hover:bg-text-olive-deep hover:text-white transition-all"
        >
          {{ section.settings.view_all_text }}
          <span class="material-symbols-outlined text-lg">arrow_forward</span>
        </a>
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Collection List",
  "tag": "section",
  "class": "section-collection-list",
  "settings": [
    {
      "type": "text",
      "id": "overline",
      "label": "Overline",
      "default": "Explore"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop by Collection"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "range",
      "id": "columns_per_row",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Columns per row"
    },
    {
      "type": "header",
      "content": "View All Link"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show view all link",
      "default": true
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View all text",
      "default": "View All Collections"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View all link",
      "default": "/collections"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "text",
          "id": "overline",
          "label": "Overline",
          "default": "12 Products"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection List",
      "category": "Collections",
      "blocks": [
        {
          "type": "collection"
        },
        {
          "type": "collection"
        },
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}
