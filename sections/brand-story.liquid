{% comment %}
  Estelle Atelier - Brand Story Section
  Immersive storytelling section for about/brand pages
{% endcomment %}

<div class="relative" data-section-id="{{ section.id }}">
  <!-- Hero Image -->
  {% if section.settings.hero_image != blank %}
    <div class="relative h-[60vh] md:h-[80vh] overflow-hidden">
      {{ section.settings.hero_image | image_url: width: 2000 | image_tag: class: 'absolute inset-0 w-full h-full object-cover', loading: 'lazy' }}
      <div class="absolute inset-0 bg-gradient-to-b from-text-olive-deep/30 via-transparent to-text-olive-deep/60"></div>
    </div>
  {% endif %}

  <!-- Content -->
  <div class="relative px-6 md:px-12 lg:px-20 xl:px-32">
    <div class="max-w-4xl mx-auto">
      <!-- Intro -->
      <div class="-mt-32 relative z-10 mb-16">
        <div class="bg-white/95 backdrop-blur-sm rounded-2xl p-8 md:p-12 shadow-xl">
          {% if section.settings.label != blank %}
            <span class="text-sage-dark text-xs font-bold uppercase tracking-[0.3em] mb-4 block">{{ section.settings.label }}</span>
          {% endif %}
          <h1 class="text-text-olive-deep text-3xl md:text-5xl font-bold tracking-tight mb-6 serif">
            {{ section.settings.heading }}
          </h1>
          <p class="text-muted text-lg leading-relaxed">
            {{ section.settings.intro_text }}
          </p>
        </div>
      </div>

      <!-- Story Sections -->
      {% for block in section.blocks %}
        <div class="py-16 md:py-24 {% unless forloop.first %}border-t border-sage-accent/30{% endunless %}" {{ block.shopify_attributes }}>
          {% case block.type %}
            {% when 'storyChapter' %}
              <div class="grid md:grid-cols-2 gap-12 items-center {% if forloop.index == 2 %}md:flex-row-reverse{% endif %}">
                {% if block.settings.image %}
                  <div class="aspect-[4/5] rounded-2xl overflow-hidden">
                    {{ block.settings.image | image_url: width: 800 | image_tag: class: 'w-full h-full object-cover', loading: 'lazy' }}
                  </div>
                {% else %}
                  <div class="aspect-[4/5] bg-sage-pale rounded-2xl"></div>
                {% endif %}
                <div>
                  {% if block.settings.chapter_label %}
                    <span class="text-sage-dark text-xs font-bold uppercase tracking-[0.3em] mb-2 block">{{ block.settings.chapter_label }}</span>
                  {% endif %}
                  <h2 class="text-text-olive-deep text-2xl md:text-3xl font-bold mb-6 serif">{{ block.settings.chapter_title }}</h2>
                  <div class="prose prose-sage max-w-none">
                    {{ block.settings.chapter_content }}
                  </div>
                </div>
              </div>

            {% when 'valuesGrid' %}
              <div class="text-center mb-12">
                <h2 class="text-text-olive-deep text-2xl md:text-3xl font-bold mb-4">{{ block.settings.values_heading }}</h2>
                <p class="text-muted max-w-2xl mx-auto">{{ block.settings.values_description }}</p>
              </div>
              <div class="grid md:grid-cols-{{ block.settings.columns }} gap-8">
                {% for i in (1..6) %}
                  {% capture value_icon %}value_{{ i }}_icon{% endcapture %}
                  {% capture value_title %}value_{{ i }}_title{% endcapture %}
                  {% capture value_text %}value_{{ i }}_text{% endcapture %}

                  {% if block.settings[value_title] != blank %}
                    <div class="text-center">
                      <div class="w-16 h-16 rounded-full bg-sage-dark/10 flex items-center justify-center mx-auto mb-4">
                        {% render 'icon', icon: block.settings[value_icon] | default: 'diamond', size: 'xl' %}
                      </div>
                      <h3 class="text-text-olive-deep font-bold mb-2">{{ block.settings[value_title] }}</h3>
                      <p class="text-muted text-sm">{{ block.settings[value_text] }}</p>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>

            {% when 'timeline' %}
              <div class="max-w-3xl mx-auto">
                <h2 class="text-text-olive-deep text-2xl md:text-3xl font-bold text-center mb-12">{{ block.settings.timeline_heading }}</h2>
                <div class="relative">
                  <!-- Timeline Line -->
                  <div class="absolute left-8 md:left-1/2 top-0 bottom-0 w-px bg-sage-accent"></div>

                  <!-- Timeline Items -->
                  {% for i in (1..4) %}
                    {% capture year %}timeline_{{ i }}_year{% endcapture %}
                    {% capture title %}timeline_{{ i }}_title{% endcapture %}
                    {% capture text %}timeline_{{ i }}_text{% endcapture %}

                    {% if block.settings[year] != blank %}
                      <div class="relative flex items-center gap-8 mb-12 {% if forindex == 2 or forindex == 4 %}md:flex-row-reverse{% endif %}">
                        <div class="hidden md:block flex-1 {% if forindex == 1 or forindex == 3 %}text-right{% endif %}"></div>
                        <div class="absolute left-8 md:left-1/2 md:-translate-x-1/2 w-4 h-4 rounded-full bg-sage-dark border-4 border-sage-accent/30 z-10"></div>
                        <div class="ml-16 md:ml-0 md:w-1/2">
                          <span class="text-sage-dark text-sm font-bold">{{ block.settings[year] }}</span>
                          <h3 class="text-text-olive-deep font-bold">{{ block.settings[title] }}</h3>
                          <p class="text-muted text-sm">{{ block.settings[text] }}</p>
                        </div>
                      </div>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>

            {% when 'imageFull' %}
              <div class="relative aspect-[16/9] md:aspect-[21/9] rounded-2xl overflow-hidden">
                {% if block.settings.image %}
                  {{ block.settings.image | image_url: width: 2000 | image_tag: class: 'w-full h-full object-cover', loading: 'lazy' }}
                {% else %}
                  <div class="w-full h-full bg-sage-pale"></div>
                {% endif %}
                {% if block.settings.overlay_text %}
                  <div class="absolute inset-0 flex items-center justify-center bg-text-olive-deep/40">
                    <div class="text-center text-white max-w-2xl px-8">
                      <h3 class="text-3xl md:text-5xl font-bold mb-4">{{ block.settings.overlay_title }}</h3>
                      <p class="text-lg opacity-90">{{ block.settings.overlay_text }}</p>
                    </div>
                  </div>
                {% endif %}
              </div>

            {% when 'cta' %}
              <div class="bg-sage-pale rounded-2xl p-12 text-center">
                <h2 class="text-text-olive-deep text-2xl md:text-3xl font-bold mb-4">{{ block.settings.cta_heading }}</h2>
                <p class="text-muted mb-8 max-w-xl mx-auto">{{ block.settings.cta_text }}</p>
                <a href="{{ block.settings.cta_link }}" class="inline-flex items-center gap-2 bg-sage-dark text-white px-8 py-4 rounded-lg font-bold hover:bg-sage-accent transition-colors">
                  {{ block.settings.cta_button }}
                  <span class="material-symbols-outlined">arrow_forward</span>
                </a>
              </div>
          {% endcase %}
        </div>
      {% endfor %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Brand Story",
  "tag": "section",
  "class": "section-brand-story",
  "settings": [
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero image"
    },
    {
      "type": "text",
      "id": "label",
      "label": "Label",
      "default": "Our Story"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Estelle Atelier"
    },
    {
      "type": "textarea",
      "id": "intro_text",
      "label": "Introduction text",
      "default": "Founded in 2024, Estelle Atelier was born from a passion for timeless elegance and sustainable luxury fashion."
    }
  ],
  "blocks": [
    {
      "type": "storyChapter",
      "name": "Story Chapter",
      "settings": [
        {
          "type": "text",
          "id": "chapter_label",
          "label": "Chapter label",
          "default": "Chapter 01"
        },
        {
          "type": "text",
          "id": "chapter_title",
          "label": "Chapter title",
          "default": "The Beginning"
        },
        {
          "type": "richtext",
          "id": "chapter_content",
          "label": "Chapter content",
          "default": "<p>Our journey began with a simple vision: to create beautiful, sustainable pieces that stand the test of time.</p>"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Chapter image"
        }
      ]
    },
    {
      "type": "valuesGrid",
      "name": "Values Grid",
      "settings": [
        {
          "type": "text",
          "id": "values_heading",
          "label": "Heading",
          "default": "Our Values"
        },
        {
          "type": "textarea",
          "id": "values_description",
          "label": "Description",
          "default": "The principles that guide everything we do."
        },
        {
          "type": "range",
          "id": "columns",
          "min": 2,
          "max": 3,
          "step": 1,
          "default": 3,
          "label": "Columns"
        },
        {
          "type": "header",
          "content": "Value 1"
        },
        {
          "type": "text",
          "id": "value_1_icon",
          "label": "Icon",
          "default": "eco"
        },
        {
          "type": "text",
          "id": "value_1_title",
          "label": "Title",
          "default": "Sustainability"
        },
        {
          "type": "text",
          "id": "value_1_text",
          "label": "Text",
          "default": "Ethically sourced materials"
        },
        {
          "type": "header",
          "content": "Value 2"
        },
        {
          "type": "text",
          "id": "value_2_icon",
          "label": "Icon",
          "default": "diamond"
        },
        {
          "type": "text",
          "id": "value_2_title",
          "label": "Title",
          "default": "Quality"
        },
        {
          "type": "text",
          "id": "value_2_text",
          "label": "Text",
          "default": "Craftsmanship that lasts"
        },
        {
          "type": "header",
          "content": "Value 3"
        },
        {
          "type": "text",
          "id": "value_3_icon",
          "label": "Icon",
          "default": "favorite"
        },
        {
          "type": "text",
          "id": "value_3_title",
          "label": "Title",
          "default": "Timeless Design"
        },
        {
          "type": "text",
          "id": "value_3_text",
          "label": "Text",
          "default": "Classic silhouettes"
        }
      ]
    },
    {
      "type": "timeline",
      "name": "Timeline",
      "settings": [
        {
          "type": "text",
          "id": "timeline_heading",
          "label": "Heading",
          "default": "Our Journey"
        },
        {
          "type": "header",
          "content": "Timeline Item 1"
        },
        {
          "type": "text",
          "id": "timeline_1_year",
          "label": "Year",
          "default": "2020"
        },
        {
          "type": "text",
          "id": "timeline_1_title",
          "label": "Title",
          "default": "The Vision"
        },
        {
          "type": "text",
          "id": "timeline_1_text",
          "label": "Text",
          "default": "First sketches of our vision"
        },
        {
          "type": "header",
          "content": "Timeline Item 2"
        },
        {
          "type": "text",
          "id": "timeline_2_year",
          "label": "Year",
          "default": "2022"
        },
        {
          "type": "text",
          "id": "timeline_2_title",
          "label": "Title",
          "default": "First Collection"
        },
        {
          "type": "text",
          "id": "timeline_2_text",
          "label": "Text",
          "default": "Launched our debut collection"
        },
        {
          "type": "header",
          "content": "Timeline Item 3"
        },
        {
          "type": "text",
          "id": "timeline_3_year",
          "label": "Year",
          "default": "2024"
        },
        {
          "type": "text",
          "id": "timeline_3_title",
          "label": "Title",
          "default": "Global Expansion"
        },
        {
          "type": "text",
          "id": "timeline_3_text",
          "label": "Text",
          "default": "Expanded to international markets"
        }
      ]
    },
    {
      "type": "imageFull",
      "name": "Full Width Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "overlay_title",
          "label": "Overlay title"
        },
        {
          "type": "textarea",
          "id": "overlay_text",
          "label": "Overlay text"
        }
      ]
    },
    {
      "type": "cta",
      "name": "Call to Action",
      "settings": [
        {
          "type": "text",
          "id": "cta_heading",
          "label": "Heading",
          "default": "Join Our Journey"
        },
        {
          "type": "textarea",
          "id": "cta_text",
          "label": "Text",
          "default": "Be the first to know about new collections and exclusive offers."
        },
        {
          "type": "text",
          "id": "cta_button",
          "label": "Button text",
          "default": "Subscribe to Newsletter"
        },
        {
          "type": "url",
          "id": "cta_link",
          "label": "Button link",
          "default": "#"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Brand Story",
      "category": "Content",
      "blocks": [
        {
          "type": "storyChapter"
        },
        {
          "type": "valuesGrid"
        },
        {
          "type": "cta"
        }
      ]
    }
  ]
}
{% endschema %}
