<header class="flex items-center justify-between px-6 md:px-12 py-6 md:py-10 sticky top-0 bg-white/90 backdrop-blur-lg z-50 border-b border-gray-50 animate-entrance delay-100" id="MainHeader">
  <div class="flex-1 hidden lg:flex items-center gap-12">
    <nav class="flex items-center gap-10">
      {%- for link in section.settings.menu.links -%}
        <div class="relative group">
          <a class="nav-link text-[10px] font-medium uppercase tracking-[0.3em] text-[var(--text-charcoal)] flex items-center gap-1" href="{{ link.url }}">
            {{ link.title }}
            {%- if link.links != blank -%}
              <span class="material-symbols-outlined text-[12px]">expand_more</span>
            {%- endif -%}
          </a>

          {%- if link.links != blank -%}
            <div class="absolute left-0 top-full pt-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
              <div class="bg-white border border-sage-accent/20 shadow-xl min-w-[200px] py-4">
                {%- for childlink in link.links -%}
                  <a href="{{ childlink.url }}" class="block px-6 py-2 text-[10px] uppercase tracking-[0.2em] text-[var(--text-muted)] hover:text-[var(--text-charcoal)] hover:bg-sage-pale/30 transition-colors">
                    {{ childlink.title }}
                  </a>
                {%- endfor -%}
              </div>
            </div>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </nav>
  </div>

  <div class="flex lg:hidden flex-1">
    <button type="button" class="text-[var(--text-charcoal)]" id="MobileMenuTrigger">
      <span class="material-symbols-outlined">menu</span>
    </button>
  </div>

  <div class="flex flex-col items-center">
    <a href="{{ routes.root_url }}" class="flex flex-col items-center">
      <h1 class="text-[var(--text-charcoal)] text-2xl md:text-4xl tracking-[0.2em] serif font-light">{{ shop.name }}</h1>
      <p class="text-[8px] tracking-[0.8em] uppercase -mt-1 text-[var(--text-muted)]">Atelier</p>
    </a>
  </div>

  <div class="flex-1 flex justify-end gap-4 md:gap-8 items-center">
    <button class="flex items-center justify-center text-[var(--text-charcoal)] hover:text-[var(--sage-dark)] transition-colors">
      <span class="material-symbols-outlined font-extralight text-xl">search</span>
    </button>
    <a href="{{ routes.account_url }}" class="hidden md:flex items-center justify-center text-[var(--text-charcoal)] hover:text-[var(--sage-dark)] transition-colors">
      <span class="material-symbols-outlined font-extralight text-xl">person</span>
    </a>
    <a href="{{ routes.cart_url }}" class="flex items-center justify-center text-[var(--text-charcoal)] relative hover:text-[var(--sage-dark)] transition-colors">
      <span class="material-symbols-outlined font-extralight text-xl">shopping_bag</span>
      <span class="absolute -top-1 -right-1 text-[8px] font-medium">{{ cart.item_count }}</span>
    </a>
  </div>
</header>

<div id="MobileMenu" class="fixed inset-0 z-[60] bg-white transform translate-x-full transition-transform duration-500 lg:hidden">
  <div class="flex flex-col h-full">
    <div class="flex justify-between items-center px-6 py-8 border-b border-gray-50">
      <span class="text-[10px] uppercase tracking-[0.3em] font-medium">Menu</span>
      <button type="button" id="MobileMenuClose">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <nav class="flex-1 overflow-y-auto py-8 px-6">
      <ul class="flex flex-col gap-8">
        {%- for link in section.settings.menu.links -%}
          <li>
            <a href="{{ link.url }}" class="text-lg serif italic text-[var(--text-charcoal)] flex justify-between items-center">
              {{ link.title }}
              {%- if link.links != blank -%}
                <span class="material-symbols-outlined">chevron_right</span>
              {%- endif -%}
            </a>
          </li>
        {%- endfor -%}
      </ul>
    </nav>
    <div class="p-6 border-t border-gray-50 flex flex-col gap-6">
       <a href="{{ routes.account_url }}" class="text-[10px] uppercase tracking-[0.3em] flex items-center gap-3">
         <span class="material-symbols-outlined text-lg">person</span>
         Account
       </a>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const trigger = document.getElementById('MobileMenuTrigger');
    const close = document.getElementById('MobileMenuClose');
    const menu = document.getElementById('MobileMenu');

    if (trigger && menu) {
      trigger.addEventListener('click', () => {
        menu.classList.remove('translate-x-full');
        document.body.style.overflow = 'hidden';
      });
    }

    if (close && menu) {
      close.addEventListener('click', () => {
        menu.classList.add('translate-x-full');
        document.body.style.overflow = '';
      });
    }
  });
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    }
  ]
}
{% endschema %}
