{% comment %}
  Estelle Atelier - Recommended Products Section
  Product recommendations based on current product or collection
{% endcomment %}

{% assign recommendations = false %}
{% if recommendation.products != blank and recommendation.products.size > 0 %}
  {% assign recommendations = true %}
{% endif %}

{% if section.settings.show_product_recommendations and recommendations %}
  <div class="px-6 md:px-12 py-16 md:py-24" data-section-id="{{ section.id }}">
    <div class="max-w-[1800px] mx-auto">
      <!-- Section Header -->
      <div class="flex items-center justify-between mb-12">
        <h2 class="text-text-olive-deep text-2xl md:text-3xl font-bold tracking-tight">
          {{ section.settings.heading }}
        </h2>
        {% if section.settings.show_view_all %}
          <a href="{{ section.settings.view_all_link }}" class="text-sm font-semibold text-sage-dark underline underline-offset-4 decoration-sage-dark/30 hover:decoration-sage-dark transition-all">
            {{ section.settings.view_all_text }}
          </a>
        {% endif %}
      </div>

      <!-- Products Grid -->
      <div class="grid grid-cols-2 md:grid-cols-{{ section.settings.columns }} gap-4 md:gap-6">
        {% for product in recommendation.products limit: section.settings.products_to_show %}
          <div data-animate>
            {% render 'card-product',
              card_product: product,
              show_vendor: section.settings.show_vendor,
              show_secondary_image: section.settings.show_secondary_image,
              show_quick_add: section.settings.show_quick_add
            %}
          </div>
        {% endfor %}
      </div>

      <!-- View All Button (Mobile) -->
      {% if section.settings.show_view_all %}
        <div class="mt-8 text-center md:hidden">
          <a href="{{ section.settings.view_all_link }}" class="inline-block bg-sage-dark text-white px-8 py-4 rounded-lg text-sm font-bold uppercase tracking-widest">
            {{ section.settings.view_all_text }}
          </a>
        </div>
      {% endif %}
    </div>
  </div>
{% endif %}

{% schema %}
{
  "name": "Recommended Products",
  "tag": "section",
  "class": "section-recommended-products",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_product_recommendations",
      "label": "Show recommendations",
      "default": true,
      "info": "Requires product recommendations to be set up"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Recommended for You"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 8,
      "step": 1,
      "default": 4,
      "label": "Products to show"
    },
    {
      "type": "range",
      "id": "columns",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 4,
      "label": "Columns"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show view all link",
      "default": true
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View all text",
      "default": "View All"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View all link",
      "default": "/collections/all"
    },
    {
      "type": "header",
      "content": "Product Card Settings"
    },
    {
      "type": "checkbox",
      "id": "show_quick_add",
      "label": "Show quick add button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "label": "Show secondary image on hover",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Recommended Products",
      "category": "Products"
    }
  ]
}
{% endschema %}
